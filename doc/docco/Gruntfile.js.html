---
layout: doccopage
title: "Gruntfile.js"
toc: false
---
<div id="container"><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>Gruntfile.js</h1><div class="filepath">Gruntfile.js</div></th><th class="code"></th></tr></thead><tbody><tr class="section" id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span></span><span id="line-1"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span><span id="line-2">
</span><span id="line-3">
</span><span id="line-4"></pre></div></td></tr><tr class="section" id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><div class="dox"><div class="summary"><p>global module: false</p></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-5">
</span><span id="line-6"><span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;chalk&#39;</span> <span class="p">);</span>
</span><span id="line-7"><span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;path&#39;</span> <span class="p">);</span>
</span><span id="line-8">
</span><span id="line-9"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">gruntInit</span><span class="p">(</span> <span class="nx">grunt</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-10">
</span><span id="line-11"></pre></div></td></tr><tr class="section" id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>Project configuration.</p></td><td class="code"><div class="highlight"><pre></span><span id="line-12">
</span><span id="line-13">    <span class="kr">const</span> <span class="nx">baseDocPath</span> <span class="o">=</span> <span class="s1">&#39;doc&#39;</span><span class="p">;</span>
</span><span id="line-14">    <span class="kr">const</span> <span class="nx">testFiles</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;index.js&#39;</span><span class="p">,</span> <span class="s1">&#39;defineGlobals.js&#39;</span><span class="p">,</span> <span class="s1">&#39;models/**/*.js&#39;</span><span class="p">,</span> <span class="s1">&#39;adapters/index.js&#39;</span><span class="p">,</span> <span class="s1">&#39;adapters/inMemory.js&#39;</span><span class="p">,</span> <span class="s1">&#39;adapters/browserStorage.js&#39;</span><span class="p">,</span> <span class="s1">&#39;adapters/utils.js&#39;</span><span class="p">,</span> <span class="s1">&#39;testApps/**/*.js&#39;</span> <span class="p">];</span>
</span><span id="line-15">    <span class="kr">const</span> <span class="nx">doccoPath</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span> <span class="nx">baseDocPath</span> <span class="si">}</span><span class="sb">/docco`</span><span class="p">;</span>
</span><span id="line-16">    <span class="kr">const</span> <span class="nx">jsdocPath</span> <span class="o">=</span> <span class="sb">`</span><span class="si">${</span> <span class="nx">baseDocPath</span> <span class="si">}</span><span class="sb">/jsdoc`</span><span class="p">;</span>
</span><span id="line-17">    <span class="kr">const</span> <span class="nx">jsAssets</span> <span class="o">=</span> <span class="cm">/*[&#39;lib/adapters/baseAdapter.js&#39;] ||*/</span> <span class="p">[</span>
</span><span id="line-18">        <span class="s1">&#39;Gruntfile.js&#39;</span><span class="p">,</span>
</span><span id="line-19">        <span class="s1">&#39;diaspora.js&#39;</span><span class="p">,</span>
</span><span id="line-20">        <span class="s1">&#39;lib/**/*.js&#39;</span><span class="p">,</span>
</span><span id="line-21">        <span class="s1">&#39;!node_modules/**/*&#39;</span><span class="p">,</span>
</span><span id="line-22">    <span class="p">];</span>
</span><span id="line-23">    <span class="kr">const</span> <span class="nx">jsFilesWTests</span> <span class="o">=</span> <span class="nx">jsAssets</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span>
</span><span id="line-24">        <span class="s1">&#39;test/**/*.js&#39;</span><span class="p">,</span>
</span><span id="line-25">        <span class="s1">&#39;!test/browser/**/*.js&#39;</span><span class="p">,</span>
</span><span id="line-26">        <span class="s1">&#39;test/browser/selenium.js&#39;</span><span class="p">,</span>
</span><span id="line-27">    <span class="p">]);</span>
</span><span id="line-28">
</span><span id="line-29">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
</span><span id="line-30">        <span class="nx">pkg</span><span class="o">:</span>    <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">readJSON</span><span class="p">(</span> <span class="s1">&#39;package.json&#39;</span> <span class="p">),</span>
</span><span id="line-31">        <span class="nx">eslint</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-32">            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-33">                <span class="nx">format</span><span class="o">:</span>     <span class="s1">&#39;stylish&#39;</span><span class="p">,</span> <span class="c1">//&#39;node_modules/eslint-tap&#39;,</span>
</span><span id="line-34">                <span class="nx">fix</span><span class="o">:</span>        <span class="kc">true</span><span class="p">,</span>
</span><span id="line-35">                <span class="nx">configFile</span><span class="o">:</span> <span class="s1">&#39;eslint-es6-node.json&#39;</span><span class="p">,</span>
</span><span id="line-36">            <span class="p">},</span>
</span><span id="line-37">            <span class="nx">info</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-38">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-39">                    <span class="nx">silent</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-40">                <span class="p">},</span>
</span><span id="line-41">                <span class="nx">src</span><span class="o">:</span> <span class="nx">jsFilesWTests</span><span class="p">,</span>
</span><span id="line-42">            <span class="p">},</span>
</span><span id="line-43">            <span class="nx">strict</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-44">                <span class="nx">options</span><span class="o">:</span> <span class="p">{},</span>
</span><span id="line-45">                <span class="nx">src</span><span class="o">:</span>     <span class="nx">jsFilesWTests</span><span class="p">,</span>
</span><span id="line-46">            <span class="p">},</span>
</span><span id="line-47">        <span class="p">},</span>
</span><span id="line-48">        <span class="nx">docco_husky</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-49">            <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-50">                <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-51">                <span class="nx">src</span><span class="o">:</span>    <span class="nx">jsFilesWTests</span><span class="p">,</span>
</span><span id="line-52">            <span class="p">},</span>
</span><span id="line-53">            <span class="nx">output_dir</span><span class="o">:</span>   <span class="nx">doccoPath</span><span class="p">,</span>
</span><span id="line-54">            <span class="nx">project_name</span><span class="o">:</span> <span class="s1">&#39;Diaspora&#39;</span><span class="p">,</span>
</span><span id="line-55">            <span class="nx">template_dir</span><span class="o">:</span> <span class="s1">&#39;node_modules/diaspora_doc/docco&#39;</span><span class="p">,</span>
</span><span id="line-56">            <span class="nx">readme</span><span class="o">:</span>       <span class="s1">&#39;README-docco.md&#39;</span><span class="p">,</span>
</span><span id="line-57">        <span class="p">},</span>
</span><span id="line-58">        <span class="nx">jsdoc</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-59">            <span class="nx">src</span><span class="o">:</span>     <span class="cm">/*[&#39;lib/adapters/baseAdapter.js&#39;],*/</span><span class="nx">jsAssets</span><span class="p">,</span>
</span><span id="line-60">            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-61">                <span class="kr">private</span><span class="o">:</span>     <span class="kc">true</span><span class="p">,</span>
</span><span id="line-62">                <span class="nx">destination</span><span class="o">:</span> <span class="nx">jsdocPath</span><span class="p">,</span>
</span><span id="line-63">                <span class="nx">config</span><span class="o">:</span>      <span class="sb">`</span><span class="si">${</span> <span class="nx">baseDocPath</span> <span class="si">}</span><span class="sb">/jsdoc.json`</span><span class="p">,</span> 
</span><span id="line-64">                <span class="nx">template</span><span class="o">:</span>    <span class="s1">&#39;node_modules/diaspora_doc/jsdoc&#39;</span><span class="p">,</span>
</span><span id="line-65">                <span class="nx">readme</span><span class="o">:</span>      <span class="s1">&#39;README-jsdoc.md&#39;</span><span class="p">,</span>
</span><span id="line-66">            <span class="p">},</span>
</span><span id="line-67">        <span class="p">},</span>
</span><span id="line-68">        <span class="nx">browserify</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-69">            <span class="nx">deps</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-70">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-71">                    <span class="nx">shim</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-72">                        <span class="nx">lodash</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-73">                            <span class="nx">path</span><span class="o">:</span>    <span class="s1">&#39;node_modules/lodash/lodash.min.js&#39;</span><span class="p">,</span>
</span><span id="line-74">                            <span class="nx">exports</span><span class="o">:</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span>
</span><span id="line-75">                        <span class="p">},</span>
</span><span id="line-76">                        <span class="s1">&#39;sequential-event&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-77">                            <span class="nx">path</span><span class="o">:</span>    <span class="s1">&#39;node_modules/sequential-event/dist/sequential-event.min.js&#39;</span><span class="p">,</span>
</span><span id="line-78">                            <span class="nx">exports</span><span class="o">:</span> <span class="s1">&#39;SequentialEvent&#39;</span><span class="p">,</span>
</span><span id="line-79">                        <span class="p">},</span>
</span><span id="line-80">                        <span class="nx">bluebird</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-81">                            <span class="nx">path</span><span class="o">:</span>    <span class="s1">&#39;node_modules/bluebird/js/browser/bluebird.min.js&#39;</span><span class="p">,</span>
</span><span id="line-82">                            <span class="nx">exports</span><span class="o">:</span> <span class="s1">&#39;Promise&#39;</span><span class="p">,</span>
</span><span id="line-83">                        <span class="p">},</span>
</span><span id="line-84">                    <span class="p">},</span>
</span><span id="line-85">                <span class="p">},</span>
</span><span id="line-86">                <span class="nx">src</span><span class="o">:</span>  <span class="p">[</span> <span class="s1">&#39;node_modules/lodash/lodash.min.js&#39;</span><span class="p">,</span> <span class="s1">&#39;node_modules/sequential-event/dist/sequential-event.min.js&#39;</span><span class="p">,</span> <span class="s1">&#39;node_modules/bluebird/js/browser/bluebird.min.js&#39;</span> <span class="p">],</span>
</span><span id="line-87">                <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;build/dependencies/src/dependencies.js&#39;</span><span class="p">,</span>
</span><span id="line-88">            <span class="p">},</span>
</span><span id="line-89">            <span class="nx">standalone</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-90">                <span class="nx">src</span><span class="o">:</span>     <span class="p">[</span> <span class="s1">&#39;diaspora.js&#39;</span><span class="p">,</span> <span class="s1">&#39;build/dependencies/dist/dependencies.min.js&#39;</span> <span class="p">],</span>
</span><span id="line-91">                <span class="nx">dest</span><span class="o">:</span>    <span class="s1">&#39;build/standalone/src/diaspora.js&#39;</span><span class="p">,</span>
</span><span id="line-92">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-93">                    <span class="nx">browserifyOptions</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-94">                        <span class="nx">standalone</span><span class="o">:</span> <span class="s1">&#39;Diaspora&#39;</span><span class="p">,</span>
</span><span id="line-95">                        <span class="nx">external</span><span class="o">:</span>   <span class="p">[</span> <span class="s1">&#39;lodash&#39;</span><span class="p">,</span> <span class="s1">&#39;bluebird&#39;</span><span class="p">,</span> <span class="s1">&#39;sequential-event&#39;</span> <span class="p">],</span>
</span><span id="line-96">                    <span class="p">},</span>
</span><span id="line-97">                <span class="p">},</span>
</span><span id="line-98">            <span class="p">},</span>
</span><span id="line-99">            <span class="nx">isolated</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-100">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-101">                    <span class="nx">browserifyOptions</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-102">                        <span class="nx">standalone</span><span class="o">:</span> <span class="s1">&#39;Diaspora&#39;</span><span class="p">,</span>
</span><span id="line-103">                    <span class="p">},</span>
</span><span id="line-104">                    <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span>
</span><span id="line-105">                        <span class="s1">&#39;lodash&#39;</span><span class="p">,</span>
</span><span id="line-106">                        <span class="s1">&#39;bluebird&#39;</span><span class="p">,</span>
</span><span id="line-107">                        <span class="s1">&#39;sequential-event&#39;</span><span class="p">,</span>
</span><span id="line-108">                    <span class="p">],</span>
</span><span id="line-109">                <span class="p">},</span>
</span><span id="line-110">                <span class="nx">src</span><span class="o">:</span>  <span class="p">[</span> <span class="s1">&#39;diaspora.js&#39;</span> <span class="p">],</span>
</span><span id="line-111">                <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;build/isolated/src/diaspora.js&#39;</span><span class="p">,</span>
</span><span id="line-112">            <span class="p">},</span>
</span><span id="line-113">            <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-114">                <span class="nx">src</span><span class="o">:</span>     <span class="nx">testFiles</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span> <span class="nx">v</span> <span class="p">=&gt;</span>  <span class="sb">`./test/</span><span class="si">${</span>  <span class="nx">v</span> <span class="si">}</span><span class="sb">`</span> <span class="p">),</span>
</span><span id="line-115">                <span class="nx">dest</span><span class="o">:</span>    <span class="s1">&#39;test/browser/unit-tests.es6.js&#39;</span><span class="p">,</span>
</span><span id="line-116">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-117">                    <span class="nx">alias</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-118">                        <span class="s1">&#39;/test/adapters/index.js&#39;</span><span class="o">:</span>          <span class="s1">&#39;./test/adapters/index.js&#39;</span><span class="p">,</span>
</span><span id="line-119">                        <span class="s1">&#39;/test/adapters/inMemory.js&#39;</span><span class="o">:</span>       <span class="s1">&#39;./test/adapters/inMemory.js&#39;</span><span class="p">,</span>
</span><span id="line-120">                        <span class="s1">&#39;/test/adapters/browserStorage.js&#39;</span><span class="o">:</span> <span class="s1">&#39;./test/adapters/browserStorage.js&#39;</span><span class="p">,</span>
</span><span id="line-121">                        <span class="s1">&#39;/test/models/index.js&#39;</span><span class="o">:</span>            <span class="s1">&#39;./test/models/index.js&#39;</span><span class="p">,</span>
</span><span id="line-122">                        <span class="s1">&#39;/test/models/simple.js&#39;</span><span class="o">:</span>           <span class="s1">&#39;./test/models/simple.js&#39;</span><span class="p">,</span>
</span><span id="line-123">                        <span class="s1">&#39;/test/models/simple-remapping.js&#39;</span><span class="o">:</span> <span class="s1">&#39;./test/models/simple-remapping.js&#39;</span><span class="p">,</span>
</span><span id="line-124">                        <span class="s1">&#39;/test/models/validations.js&#39;</span><span class="o">:</span>      <span class="s1">&#39;./test/models/validations.js&#39;</span><span class="p">,</span>
</span><span id="line-125">                        <span class="s1">&#39;/test/models/components.js&#39;</span><span class="o">:</span>       <span class="s1">&#39;./test/models/components.js&#39;</span><span class="p">,</span>
</span><span id="line-126">                    <span class="p">},</span>
</span><span id="line-127">                    <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;./browser/selenium.js&#39;</span><span class="p">,</span> <span class="s1">&#39;./config.js&#39;</span><span class="p">,</span> <span class="s1">&#39;chai&#39;</span><span class="p">,</span> <span class="s1">&#39;../diaspora&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;chalk&#39;</span><span class="p">,</span> <span class="s1">&#39;stack-trace&#39;</span><span class="p">,</span> <span class="s1">&#39;expect.js&#39;</span><span class="p">,</span> <span class="s1">&#39;node-localstorage&#39;</span><span class="p">,</span> <span class="s1">&#39;fs&#39;</span> <span class="p">],</span>
</span><span id="line-128">                    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-129">                        <span class="nx">browserifyOptions</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-130">                            <span class="nx">fullPaths</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span id="line-131">                        <span class="p">},</span>
</span><span id="line-132">                    <span class="p">},</span>
</span><span id="line-133">                <span class="p">},</span>
</span><span id="line-134">            <span class="p">},</span>
</span><span id="line-135">        <span class="p">},</span>
</span><span id="line-136">        <span class="nx">babel</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-137">            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-138">                <span class="nx">sourceMap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-139">                <span class="nx">presets</span><span class="o">:</span>   <span class="p">[[</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span id="line-140">                    <span class="nx">modules</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span id="line-141">                    <span class="nx">targets</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-142">                        <span class="nx">browsers</span><span class="o">:</span> <span class="s1">&#39;&gt;= 1%&#39;</span><span class="p">,</span>
</span><span id="line-143">                    <span class="p">},</span>
</span><span id="line-144">                <span class="p">}]],</span>
</span><span id="line-145">
</span><span id="line-146"></pre></div></td></tr><tr class="section" id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><pre><code>        plugins: [ 'babel-plugin-proxy' ],
</code></pre></td><td class="code"><div class="highlight"><pre></span><span id="line-147">            <span class="p">},</span>
</span><span id="line-148">            <span class="nx">deps</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-149">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-150">                    <span class="nx">sourceMap</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span id="line-151">                <span class="p">},</span>
</span><span id="line-152">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-153">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-154">                    <span class="nx">cwd</span><span class="o">:</span>    <span class="s1">&#39;build/dependencies/src&#39;</span><span class="p">,</span>
</span><span id="line-155">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;dependencies.js&#39;</span> <span class="p">],</span>
</span><span id="line-156">                    <span class="nx">dest</span><span class="o">:</span>   <span class="s1">&#39;build/dependencies/dist&#39;</span><span class="p">,</span>
</span><span id="line-157">                    <span class="nx">ext</span><span class="o">:</span>    <span class="s1">&#39;.js&#39;</span><span class="p">,</span>
</span><span id="line-158">                <span class="p">}],</span>
</span><span id="line-159">            <span class="p">},</span>
</span><span id="line-160">            <span class="nx">standalone</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-161">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-162">                    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span><span id="line-163">                        <span class="p">[</span> <span class="s1">&#39;@comandeer/babel-plugin-banner&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span id="line-164">                            <span class="nx">banner</span><span class="o">:</span> <span class="sb">`/**</span>
</span><span id="line-165"><span class="sb">* @file &lt;%= pkg.name %&gt;</span>
</span><span id="line-166"><span class="sb">* </span>
</span><span id="line-167"><span class="sb">* &lt;%= pkg.description %&gt;</span>
</span><span id="line-168"><span class="sb">* Standalone build compiled on &lt;%= grunt.template.today(&quot;yyyy-mm-dd hh:MM:ss&quot;) %&gt;</span>
</span><span id="line-169"><span class="sb">*</span>
</span><span id="line-170"><span class="sb">* @license &lt;%= pkg.license %&gt;</span>
</span><span id="line-171"><span class="sb">* @version &lt;%= pkg.version %&gt;</span>
</span><span id="line-172"><span class="sb">* @author &lt;%= pkg.author %&gt;</span>
</span><span id="line-173"><span class="sb">*/`</span><span class="p">,</span>
</span><span id="line-174">                        <span class="p">}],</span>
</span><span id="line-175">                    <span class="p">],</span>
</span><span id="line-176">                <span class="p">},</span>
</span><span id="line-177">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-178">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-179">                    <span class="nx">cwd</span><span class="o">:</span>    <span class="s1">&#39;build/standalone/src&#39;</span><span class="p">,</span>
</span><span id="line-180">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;diaspora.js&#39;</span> <span class="p">],</span>
</span><span id="line-181">                    <span class="nx">dest</span><span class="o">:</span>   <span class="s1">&#39;build/standalone/dist&#39;</span><span class="p">,</span>
</span><span id="line-182">                    <span class="nx">ext</span><span class="o">:</span>    <span class="s1">&#39;.js&#39;</span><span class="p">,</span>
</span><span id="line-183">                <span class="p">}],</span>
</span><span id="line-184">            <span class="p">},</span>
</span><span id="line-185">            <span class="nx">isolated</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-186">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-187">                    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span><span id="line-188">                        <span class="p">[</span> <span class="s1">&#39;@comandeer/babel-plugin-banner&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span id="line-189">                            <span class="nx">banner</span><span class="o">:</span> <span class="sb">`/**</span>
</span><span id="line-190"><span class="sb">* @file &lt;%= pkg.name %&gt;</span>
</span><span id="line-191"><span class="sb">* </span>
</span><span id="line-192"><span class="sb">* &lt;%= pkg.description %&gt;</span>
</span><span id="line-193"><span class="sb">* Isolated build compiled on &lt;%= grunt.template.today(&quot;yyyy-mm-dd hh:MM:ss&quot;) %&gt;</span>
</span><span id="line-194"><span class="sb">*</span>
</span><span id="line-195"><span class="sb">* @license &lt;%= pkg.license %&gt;</span>
</span><span id="line-196"><span class="sb">* @version &lt;%= pkg.version %&gt;</span>
</span><span id="line-197"><span class="sb">* @author &lt;%= pkg.author %&gt;</span>
</span><span id="line-198"><span class="sb">*/`</span><span class="p">,</span>
</span><span id="line-199">                        <span class="p">}],</span>
</span><span id="line-200">                    <span class="p">],</span>
</span><span id="line-201">                <span class="p">},</span>
</span><span id="line-202">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-203">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-204">                    <span class="nx">cwd</span><span class="o">:</span>    <span class="s1">&#39;build/isolated/src&#39;</span><span class="p">,</span>
</span><span id="line-205">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;diaspora.js&#39;</span> <span class="p">],</span>
</span><span id="line-206">                    <span class="nx">dest</span><span class="o">:</span>   <span class="s1">&#39;build/isolated/dist&#39;</span><span class="p">,</span>
</span><span id="line-207">                    <span class="nx">ext</span><span class="o">:</span>    <span class="s1">&#39;.js&#39;</span><span class="p">,</span>
</span><span id="line-208">                <span class="p">}],</span>
</span><span id="line-209">            <span class="p">},</span>
</span><span id="line-210">            <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-211">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-212">                    <span class="nx">sourceMap</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span id="line-213">                <span class="p">},</span>
</span><span id="line-214">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-215">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-216">                    <span class="nx">src</span><span class="o">:</span>    <span class="s1">&#39;test/browser/unit-tests.es6.js&#39;</span><span class="p">,</span>
</span><span id="line-217">                    <span class="nx">dest</span><span class="o">:</span>   <span class="s1">&#39;./&#39;</span><span class="p">,</span>
</span><span id="line-218">                    <span class="nx">ext</span><span class="o">:</span>    <span class="s1">&#39;.js&#39;</span><span class="p">,</span>
</span><span id="line-219">                <span class="p">}],</span>
</span><span id="line-220">            <span class="p">},</span>
</span><span id="line-221">        <span class="p">},</span>
</span><span id="line-222">        <span class="nx">uglify</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-223">            <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-224">                <span class="nx">sourceMap</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-225">                <span class="nx">output</span><span class="o">:</span>    <span class="p">{</span>
</span><span id="line-226">                    <span class="nx">comments</span><span class="o">:</span> <span class="s1">&#39;some&#39;</span><span class="p">,</span>
</span><span id="line-227">                <span class="p">},</span>
</span><span id="line-228">            <span class="p">},</span>
</span><span id="line-229">            <span class="nx">deps</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-230">                <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-231">                    <span class="nx">banner</span><span class="o">:</span>    <span class="kc">false</span><span class="p">,</span>
</span><span id="line-232">                    <span class="nx">sourceMap</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span id="line-233">                <span class="p">},</span>
</span><span id="line-234">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-235">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-236">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;build/dependencies/dist/dependencies.js&#39;</span> <span class="p">],</span>
</span><span id="line-237">                    <span class="nx">dest</span><span class="o">:</span>     <span class="s1">&#39;.&#39;</span><span class="p">,</span>
</span><span id="line-238">                    <span class="nx">rename</span><span class="o">:</span> <span class="p">(</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/\.js$/</span><span class="p">,</span> <span class="s1">&#39;.min.js&#39;</span> <span class="p">)),</span>
</span><span id="line-239">                <span class="p">}],</span>
</span><span id="line-240">            <span class="p">},</span>
</span><span id="line-241">            <span class="nx">standalone</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-242">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-243">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-244">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;build/standalone/dist/diaspora.js&#39;</span> <span class="p">],</span>
</span><span id="line-245">                    <span class="nx">dest</span><span class="o">:</span>     <span class="s1">&#39;.&#39;</span><span class="p">,</span>
</span><span id="line-246">                    <span class="nx">rename</span><span class="o">:</span> <span class="p">(</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/\.js$/</span><span class="p">,</span> <span class="s1">&#39;.min.js&#39;</span> <span class="p">)),</span>
</span><span id="line-247">                <span class="p">}],</span>
</span><span id="line-248">            <span class="p">},</span>
</span><span id="line-249">            <span class="nx">isolated</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-250">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-251">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-252">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;build/isolated/dist/diaspora.js&#39;</span> <span class="p">],</span>
</span><span id="line-253">                    <span class="nx">dest</span><span class="o">:</span>     <span class="s1">&#39;.&#39;</span><span class="p">,</span>
</span><span id="line-254">                    <span class="nx">rename</span><span class="o">:</span> <span class="p">(</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/\.js$/</span><span class="p">,</span> <span class="s1">&#39;.min.js&#39;</span> <span class="p">)),</span>
</span><span id="line-255">                <span class="p">}],</span>
</span><span id="line-256">            <span class="p">},</span>
</span><span id="line-257">        <span class="p">},</span>
</span><span id="line-258">        <span class="nx">copy</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-259">            <span class="nx">diaspora_to_docs_site</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-260">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-261">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-262">                    <span class="nx">cwd</span><span class="o">:</span>    <span class="s1">&#39;./build/standalone/dist/&#39;</span><span class="p">,</span>
</span><span id="line-263">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;./diaspora*.js*&#39;</span> <span class="p">],</span>
</span><span id="line-264">                    <span class="nx">dest</span><span class="o">:</span>   <span class="sb">`</span><span class="si">${</span> <span class="nx">baseDocPath</span> <span class="si">}</span><span class="sb">/assets/js/`</span><span class="p">,</span>
</span><span id="line-265">                <span class="p">}],</span>
</span><span id="line-266">            <span class="p">},</span>
</span><span id="line-267">            <span class="nx">build_isolated_to_dist</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-268">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-269">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-270">                    <span class="nx">cwd</span><span class="o">:</span>    <span class="s1">&#39;./build/isolated/dist/&#39;</span><span class="p">,</span>
</span><span id="line-271">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;./diaspora*.js*&#39;</span> <span class="p">],</span>
</span><span id="line-272">                    <span class="nx">dest</span><span class="o">:</span>   <span class="s1">&#39;dist/isolated&#39;</span><span class="p">,</span>
</span><span id="line-273">                <span class="p">}],</span>
</span><span id="line-274">            <span class="p">},</span>
</span><span id="line-275">            <span class="nx">build_standalone_to_dist</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-276">                <span class="nx">files</span><span class="o">:</span> <span class="p">[{</span>
</span><span id="line-277">                    <span class="nx">expand</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-278">                    <span class="nx">cwd</span><span class="o">:</span>    <span class="s1">&#39;./build/standalone/dist/&#39;</span><span class="p">,</span>
</span><span id="line-279">                    <span class="nx">src</span><span class="o">:</span>    <span class="p">[</span> <span class="s1">&#39;./diaspora*.js*&#39;</span> <span class="p">],</span>
</span><span id="line-280">                    <span class="nx">dest</span><span class="o">:</span>   <span class="s1">&#39;dist/standalone&#39;</span><span class="p">,</span>
</span><span id="line-281">                <span class="p">}],</span>
</span><span id="line-282">            <span class="p">},</span>
</span><span id="line-283">        <span class="p">},</span>
</span><span id="line-284">        <span class="nx">clean</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-285">            <span class="nx">doc_jsdoc</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-286">                <span class="nx">src</span><span class="o">:</span> <span class="p">[</span> <span class="sb">`</span><span class="si">${</span> <span class="nx">baseDocPath</span> <span class="si">}</span><span class="sb">/jsdoc`</span> <span class="p">],</span>
</span><span id="line-287">            <span class="p">},</span>
</span><span id="line-288">            <span class="nx">doc_docco</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-289">                <span class="nx">src</span><span class="o">:</span> <span class="p">[</span> <span class="sb">`</span><span class="si">${</span> <span class="nx">baseDocPath</span> <span class="si">}</span><span class="sb">/docco`</span> <span class="p">],</span>
</span><span id="line-290">            <span class="p">},</span>
</span><span id="line-291">        <span class="p">},</span>
</span><span id="line-292">    <span class="p">});</span>
</span><span id="line-293">
</span><span id="line-294">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-jsdoc&#39;</span> <span class="p">);</span>
</span><span id="line-295">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-docco-husky&#39;</span> <span class="p">);</span>
</span><span id="line-296">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;gruntify-eslint&#39;</span> <span class="p">);</span>
</span><span id="line-297">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-changed&#39;</span> <span class="p">);</span>
</span><span id="line-298">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-browserify&#39;</span> <span class="p">);</span>
</span><span id="line-299">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-contrib-uglify&#39;</span> <span class="p">);</span>
</span><span id="line-300">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-contrib-copy&#39;</span> <span class="p">);</span>
</span><span id="line-301">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span> <span class="s1">&#39;grunt-contrib-clean&#39;</span> <span class="p">);</span>
</span><span id="line-302">
</span><span id="line-303">    <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;load-grunt-tasks&#39;</span> <span class="p">)(</span> <span class="nx">grunt</span> <span class="p">);</span>
</span><span id="line-304">
</span><span id="line-305">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;documentate&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-306">        <span class="s1">&#39;lint&#39;</span><span class="p">,</span>
</span><span id="line-307">        <span class="s1">&#39;clean:doc_jsdoc&#39;</span><span class="p">,</span>
</span><span id="line-308">        <span class="s1">&#39;clean:doc_docco&#39;</span><span class="p">,</span>
</span><span id="line-309">        <span class="s1">&#39;jsdoc&#39;</span><span class="p">,</span>
</span><span id="line-310">        <span class="s1">&#39;docco_husky&#39;</span><span class="p">,</span>
</span><span id="line-311">    <span class="p">]);</span>
</span><span id="line-312">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-313">        <span class="s1">&#39;lint&#39;</span><span class="p">,</span>
</span><span id="line-314">        <span class="s1">&#39;buildStandalone&#39;</span><span class="p">,</span>
</span><span id="line-315">        <span class="s1">&#39;buildIsolated&#39;</span><span class="p">,</span>
</span><span id="line-316">    <span class="p">]);</span>
</span><span id="line-317">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;buildDependencies&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-318">        <span class="s1">&#39;browserify:deps&#39;</span><span class="p">,</span>
</span><span id="line-319">        <span class="s1">&#39;babel:deps&#39;</span><span class="p">,</span>
</span><span id="line-320">        <span class="s1">&#39;uglify:deps&#39;</span><span class="p">,</span>
</span><span id="line-321">    <span class="p">]);</span>
</span><span id="line-322">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;buildStandalone&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-323">
</span><span id="line-324"></pre></div></td></tr><tr class="section" id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><pre><code>'changed:buildDependencies',
</code></pre></td><td class="code"><div class="highlight"><pre></span><span id="line-325">        <span class="s1">&#39;browserify:standalone&#39;</span><span class="p">,</span>
</span><span id="line-326">        <span class="s1">&#39;babel:standalone&#39;</span><span class="p">,</span>
</span><span id="line-327">        <span class="s1">&#39;uglify:standalone&#39;</span><span class="p">,</span>
</span><span id="line-328">        <span class="s1">&#39;copy:diaspora_to_docs_site&#39;</span><span class="p">,</span>
</span><span id="line-329">        <span class="s1">&#39;copy:build_standalone_to_dist&#39;</span><span class="p">,</span>
</span><span id="line-330">    <span class="p">]);</span>
</span><span id="line-331">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;buildIsolated&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-332">        <span class="s1">&#39;browserify:isolated&#39;</span><span class="p">,</span>
</span><span id="line-333">        <span class="s1">&#39;babel:isolated&#39;</span><span class="p">,</span>
</span><span id="line-334">        <span class="s1">&#39;uglify:isolated&#39;</span><span class="p">,</span>
</span><span id="line-335">        <span class="s1">&#39;copy:build_isolated_to_dist&#39;</span><span class="p">,</span>
</span><span id="line-336">    <span class="p">]);</span>
</span><span id="line-337">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;lint&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-338">        <span class="s1">&#39;eslint:info&#39;</span><span class="p">,</span>
</span><span id="line-339">    <span class="p">]);</span>
</span><span id="line-340">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-341">        <span class="s1">&#39;refreshScripts&#39;</span><span class="p">,</span>
</span><span id="line-342">        <span class="s1">&#39;documentate&#39;</span><span class="p">,</span>
</span><span id="line-343">    <span class="p">]);</span>
</span><span id="line-344">    <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s1">&#39;refreshTests&#39;</span><span class="p">,</span> <span class="p">[</span>
</span><span id="line-345">        <span class="s1">&#39;browserify:test&#39;</span><span class="p">,</span>
</span><span id="line-346">        <span class="s1">&#39;babel:test&#39;</span><span class="p">,</span>
</span><span id="line-347">    <span class="p">]);</span>
</span><span id="line-348"><span class="p">};</span>
</span>
</pre></div></td></tr></tbody></table></div>