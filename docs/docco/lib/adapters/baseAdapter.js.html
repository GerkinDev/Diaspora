<!doctype html>
<html lang="en-US">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="chrome=1">

		<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>baseAdapter.js | Diaspora</title>
<meta property="og:title" content="baseAdapter.js" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Multi-source ORM for node.js &amp; the browser" />
<meta property="og:description" content="Multi-source ORM for node.js &amp; the browser" />
<meta property="og:site_name" content="Diaspora" />
<script type="application/ld+json">
{"name":null,"description":"Multi-source ORM for node.js &amp; the browser","author":null,"@type":"WebPage","url":"/docco/lib/adapters/baseAdapter.js.html","publisher":null,"image":null,"headline":"baseAdapter.js","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link href='https://fonts.googleapis.com/css?family=Arvo:400,700,400italic' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="../../../assets/css/style.css?v=">
		<script src="../../../assets/js/docstrap.lib.js" defer></script>
		<script src="../../../assets/js/tableHeadFixer.js" defer></script>
		<script src="../../../assets/js/scale.fix.js" defer></script>
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
	</head>
	<body data-page="/docco/lib/adapters/baseAdapter.js.html" class="doccopage">
		<nav id="header" class="navbar navbar-default navbar-fixed-top">
	<div class="navbar-header">
		<a class="navbar-brand" href="../../../index.html">Diaspora</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#mainNav">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
	</div>
	<div class="navbar-collapse collapse" id="mainNav" aria-expanded="false">
		<ul class="nav navbar-nav">
			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Guide<b class="caret"></b></a>
				<ul class="dropdown-menu">
					<li><a href="../../../index.html">Home</a></li>
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					<li><a href="../../..//create-an-adapter.html">Create a custom adapter</a></li>
					
					
					
					
					
					
					
					
					
					<li><a href="../../..//getting-started.html">Getting started</a></li>
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					<li><a href="../../..//query-language.html">Query Language</a></li>
					
					
					
					
					
					
					
					
					
					<li><a href="../../..//try-diaspora.html">Try Diaspora online</a></li>
					
					
				</ul>
			</li>
			<li id="QCR" class="dropdown">
				<a href="../../../docco/index.html" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Quick Code Review<b class="caret"></b></a>
				
				<ul class="dropdown-menu">
					

<li ><a href="../../../docco/Gruntfile.js.html" >Gruntfile.js</a>
	
</li>


<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">lib<b class="caret"></b></a>
	
	<!--{&quot;Adapters&quot;=&gt;{&quot;page&quot;=&gt;{&quot;title&quot;=&gt;&quot;adapters&quot;}, &quot;children&quot;=&gt;{&quot;BaseAdapter.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;baseAdapter.js.html&quot;&gt;}, &quot;InMemoryAdapter.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;inMemoryAdapter.js.html&quot;&gt;}, &quot;LocalStorageAdapter.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;localStorageAdapter.js.html&quot;&gt;}}}, &quot;DataStoreEntities&quot;=&gt;{&quot;page&quot;=&gt;{&quot;title&quot;=&gt;&quot;dataStoreEntities&quot;}, &quot;children&quot;=&gt;{&quot;BaseEntity.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;baseEntity.js.html&quot;&gt;}, &quot;InMemoryEntity.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;inMemoryEntity.js.html&quot;&gt;}, &quot;LocalStorageEntity.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;localStorageEntity.js.html&quot;&gt;}}}, &quot;Diaspora.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;diaspora.js.html&quot;&gt;}, &quot;EntityFactory.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;entityFactory.js.html&quot;&gt;}, &quot;Model.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;model.js.html&quot;&gt;}}-->
	<ul class="dropdown-submenu">
		

<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">adapters<b class="caret"></b></a>
	
	<!--{&quot;BaseAdapter.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;baseAdapter.js.html&quot;&gt;}, &quot;InMemoryAdapter.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;inMemoryAdapter.js.html&quot;&gt;}, &quot;LocalStorageAdapter.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;localStorageAdapter.js.html&quot;&gt;}}-->
	<ul class="dropdown-submenu">
		

<li ><a href="../../../docco/lib/adapters/baseAdapter.js.html" >baseAdapter.js</a>
	
</li>


<li ><a href="../../../docco/lib/adapters/inMemoryAdapter.js.html" >inMemoryAdapter.js</a>
	
</li>


<li ><a href="../../../docco/lib/adapters/localStorageAdapter.js.html" >localStorageAdapter.js</a>
	
</li>

	</ul>
	
</li>


<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">dataStoreEntities<b class="caret"></b></a>
	
	<!--{&quot;BaseEntity.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;baseEntity.js.html&quot;&gt;}, &quot;InMemoryEntity.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;inMemoryEntity.js.html&quot;&gt;}, &quot;LocalStorageEntity.js&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;localStorageEntity.js.html&quot;&gt;}}-->
	<ul class="dropdown-submenu">
		

<li ><a href="../../../docco/lib/dataStoreEntities/baseEntity.js.html" >baseEntity.js</a>
	
</li>


<li ><a href="../../../docco/lib/dataStoreEntities/inMemoryEntity.js.html" >inMemoryEntity.js</a>
	
</li>


<li ><a href="../../../docco/lib/dataStoreEntities/localStorageEntity.js.html" >localStorageEntity.js</a>
	
</li>

	</ul>
	
</li>


<li ><a href="../../../docco/lib/diaspora.js.html" >diaspora.js</a>
	
</li>


<li ><a href="../../../docco/lib/entityFactory.js.html" >entityFactory.js</a>
	
</li>


<li ><a href="../../../docco/lib/model.js.html" >model.js</a>
	
</li>

	</ul>
	
</li>


<li ><a href="../../../docco/diaspora.js.html" >diaspora.js</a>
	
</li>

				</ul>
			</li>
			<li id="API" class="dropdown">
				<a href="../../../jsdoc/index.html" class="dropdown-toggle long" data-toggle="dropdown" aria-expanded="false">API Documentation<b class="caret"></b></a>
				<a href="../../../jsdoc/index.html" class="dropdown-toggle short" data-toggle="dropdown" aria-expanded="false">API<b class="caret"></b></a>
				
				<ul class="dropdown-menu">
					

<li class="dropdown"><a href="../../../jsdoc/Adapters.html" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Namespace: Adapters<b class="caret"></b></a>
	
	<!--{&quot;DiasporaAdapter&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;Adapters.DiasporaAdapter.html&quot;&gt;}, &quot;InMemoryDiasporaAdapter&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;Adapters.InMemoryDiasporaAdapter.html&quot;&gt;}, &quot;LocalStorageDiasporaAdapter&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;Adapters.LocalStorageDiasporaAdapter.html&quot;&gt;}}-->
	<ul class="dropdown-submenu">
		

<li ><a href="../../../jsdoc/Adapters.DiasporaAdapter.html" >Class: DiasporaAdapter</a>
	
</li>


<li ><a href="../../../jsdoc/Adapters.InMemoryDiasporaAdapter.html" >Class: InMemoryDiasporaAdapter</a>
	
</li>


<li ><a href="../../../jsdoc/Adapters.LocalStorageDiasporaAdapter.html" >Class: LocalStorageDiasporaAdapter</a>
	
</li>

	</ul>
	
</li>


<li ><a href="../../../jsdoc/ConstrainedTypes.html" >Namespace: ConstrainedTypes</a>
	
</li>


<li class="dropdown"><a href="../../../jsdoc/DataStoreEntities.html" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Namespace: DataStoreEntities<b class="caret"></b></a>
	
	<!--{&quot;DataStoreEntity&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;DataStoreEntities.DataStoreEntity.html&quot;&gt;}, &quot;InMemoryEntity&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;DataStoreEntities.InMemoryEntity.html&quot;&gt;}, &quot;LocalStorageEntity&quot;=&gt;{&quot;page&quot;=&gt;#&lt;Jekyll:Page @name=&quot;DataStoreEntities.LocalStorageEntity.html&quot;&gt;}}-->
	<ul class="dropdown-submenu">
		

<li ><a href="../../../jsdoc/DataStoreEntities.DataStoreEntity.html" >Class: DataStoreEntity</a>
	
</li>


<li ><a href="../../../jsdoc/DataStoreEntities.InMemoryEntity.html" >Class: InMemoryEntity</a>
	
</li>


<li ><a href="../../../jsdoc/DataStoreEntities.LocalStorageEntity.html" >Class: LocalStorageEntity</a>
	
</li>

	</ul>
	
</li>


<li ><a href="../../../jsdoc/Diaspora.html" >Namespace: Diaspora</a>
	
</li>


<li ><a href="../../../jsdoc/Entity.html" >Class: Entity</a>
	
</li>


<li ><a href="../../../jsdoc/Model.html" >Class: Model</a>
	
</li>


<li ><a href="../../../jsdoc/QueryLanguage.html" >Namespace: QueryLanguage</a>
	
</li>


<li ><a href="../../../jsdoc/classes.list.html" >Classes</a>
	
</li>


<li ><a href="../../../jsdoc/global.html" >Global</a>
	
</li>


<li ><a href="../../../jsdoc/namespaces.list.html" >Namespaces</a>
	
</li>

				</ul>
			</li>
		</ul>
		<div class="col-sm-3 col-md-3">
			<form class="navbar-form" role="search" action="../../../search.html">
				<div class="input-group">
					<input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
					<div class="input-group-btn">
						<button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
					</div>
				</div>
			</form>
		</div>
	</div>
</nav >
		<div class="wrapper">

			<div id="content">
				<section>
					<div id="container"><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>baseAdapter.js</h1><div class="filepath">lib/adapters/baseAdapter.js</div></th><th class="code"></th></tr></thead><tbody><tr class="section" id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span></span><span id="line-1"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span><span id="line-2">
</span><span id="line-3"><span class="kr">const</span> <span class="nx">SequentialEvent</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;sequential-event&#39;</span> <span class="p">);</span>
</span><span id="line-4"><span class="kr">const</span> <span class="nx">_</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;lodash&#39;</span> <span class="p">);</span>
</span><span id="line-5"><span class="kr">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;check-types&#39;</span> <span class="p">);</span>
</span><span id="line-6"><span class="kr">const</span> <span class="nb">Promise</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;bluebird&#39;</span> <span class="p">);</span>
</span><span id="line-7">
</span><span id="line-8">
</span><span id="line-9">
</span><span id="line-10"></pre></div></td></tr><tr class="section" id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Namespace <em>ConstrainedTypes</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Namespace for types with constraints, like <code>[0, Infinity]</code>, <code>]0, Infinity[</code>, etc etc</p></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-11">
</span><span id="line-12">
</span><span id="line-13"></pre></div></td></tr><tr class="section" id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>AbsInt0</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-integer">Integer</span></div><div class="dox_tag_title">In: <em>ConstrainedTypes</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Integer equal or above 0</p></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-14">
</span><span id="line-15">
</span><span id="line-16"></pre></div></td></tr><tr class="section" id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>AbsInt</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-integer">Integer</span></div><div class="dox_tag_title">In: <em>ConstrainedTypes</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Integer above 0</p></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-17">
</span><span id="line-18">
</span><span id="line-19"></pre></div></td></tr><tr class="section" id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>AbsIntInf</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-integer">Integer</span></div><div class="dox_tag_title">In: <em>ConstrainedTypes</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Integer above 0, may be integer</p></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-20">
</span><span id="line-21">
</span><span id="line-22"></pre></div></td></tr><tr class="section" id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>AbsIntInf0</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-integer">Integer</span></div><div class="dox_tag_title">In: <em>ConstrainedTypes</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Integer equal or above 0, may be integer</p></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-23">
</span><span id="line-24">
</span><span id="line-25"></pre></div></td></tr><tr class="section" id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Namespace <em>QueryLanguage</em></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-26">
</span><span id="line-27">
</span><span id="line-28"></pre></div></td></tr><tr class="section" id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>QueryOptions</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-object">Object</span></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>All properties are optional</p></div><div class="dox_tag_title">In: <em>QueryLanguage</em></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Properties</div><table class="dox_properties dox_tag_detail table-striped"><tr><th>Name</th><th>Types</th><th>Description</th></tr><tr class="dox_property"><td>skip=0</td><td>ConstrainedTypes<span class="sep">.</span>AbsInt0</td><td><p>Number of items to skip</p></td></tr><tr class="dox_property"><td>limit=Infinity</td><td>ConstrainedTypes<span class="sep">.</span>AbsIntInf0</td><td><p>Number of items to get</p></td></tr><tr class="dox_property"><td>page</td><td>ConstrainedTypes<span class="sep">.</span>AbsInt0</td><td><p>To use with {@link QueryOptions.limit <code>limit</code>} and without {@link QueryOptions.skip <code>skip</code>}. Skips <code>page</code> pages of <code>limit</code> elements</p></td></tr><tr class="dox_property"><td>remapInput=true</td><td>Boolean</td><td><p>Flag indicating if adapter input should be remapped or not. TODO Remapping doc</p></td></tr><tr class="dox_property"><td>remapOutput=true</td><td>Boolean</td><td><p>Flag indicating if adapter output should be remapped or not. TODO Remapping doc</p></td></tr></table><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-29">
</span><span id="line-30">
</span><span id="line-31"></pre></div></td></tr><tr class="section" id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>SelectQuery</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-object">Object</span></div><div class="dox_tag_title">In: <em>QueryLanguage</em></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Properties</div><table class="dox_properties dox_tag_detail table-striped"><tr><th>Name</th><th>Types</th><th>Description</th></tr><tr class="dox_property"><td>*</td><td>Any<span class="sep">|</span>SelectQueryCondition</td><td><p>Fields to search. If not providing an object, find items with a property value that equals this value</p></td></tr></table><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-32">
</span><span id="line-33">
</span><span id="line-34"></pre></div></td></tr><tr class="section" id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>SelectQueryCondition</em></div><div class="dox_tag_types"><span>Types: </span><span class="dox_type type-object">Object</span></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>By default, all conditions in a single SelectQueryCondition are combined with an <code>AND</code> operator</p></div><div class="dox_tag_title">In: <em>QueryLanguage</em></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Properties</div><table class="dox_properties dox_tag_detail table-striped"><tr><th>Name</th><th>Types</th><th>Description</th></tr><tr class="dox_property"><td>$equals</td><td>Any</td><td><p>Match if item value is equal to this. Objects and array are compared deeply. <strong>Alias: <code>==</code></strong></p></td></tr><tr class="dox_property"><td>$diff</td><td>Any</td><td><p>Match if item value is different to this. Objects and array are compared deeply. <strong>Alias: <code>!=</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$exists</td><td>Boolean</td><td><p>If <code>true</code>, match items where this prop is defined. If <code>false</code>, match when prop is null or not set. <strong>Alias: <code>~</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$less</td><td>Integer</td><td><p>Match if item value is less than this. <strong>Alias: <code>&lt;</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$lessEqual</td><td>Integer</td><td><p>Match if item value is less than this or equals to this. <strong>Alias: <code>&lt;=</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$greater</td><td>Integer</td><td><p>Match if item value is greater than this. <strong>Alias: <code>&gt;</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$greaterEqual</td><td>Integer</td><td><p>Match if item value is greater than this or equals to this. <strong>Alias: <code>&gt;=</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$or</td><td></td><td><p>Match if <em>one of</em> the conditions in the array is true. <strong>Alias: <code>||</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$and</td><td></td><td><p>Match if <em>all</em> the conditions in the array are true. Optional, because several conditions in a single SelectQueryCondition are combined with an <code>AND</code> operator. <strong>Alias: <code>&amp;&amp;</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$xor</td><td></td><td><p>Match if <em>a single</em> of the conditions in the array is true. <strong>Alias: <code>^^</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$not</td><td></td><td><p>Invert the condition <strong>Alias: <code>!</code></strong> <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$contains</td><td>String</td><td><p>On <em>string</em>, it will check if query is included in item using GLOB. <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$contains</td><td></td><td><p>On <em>array</em>, it will check if item contains the query. <strong>NOT IMPLEMENTED YET</strong></p></td></tr><tr class="dox_property"><td>$in</td><td>Array<span class="sep">.</span><Any></td><td><p>Check if item value is contained (using deep comparaison) in query. <strong>NOT IMPLEMENTED YET</strong></p></td></tr></table><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-35">
</span><span id="line-36">
</span><span id="line-37"></pre></div></td></tr><tr class="section" id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Typedef <em>SelectQueryOrCondition</em></div><div class="dox_tag_types"><span>Types: </span></div><div class="dox_tag_title">In: <em>QueryLanguage</em></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-38">
</span><span id="line-39">
</span><span id="line-40"></pre></div></td></tr><tr class="section" id="section-12"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Namespace <em>Adapters</em></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-41">
</span><span id="line-42">
</span><span id="line-43"></pre></div></td></tr><tr class="section" id="section-13"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-13">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Class <em>DiasporaAdapter</em></div><div class="dox_tag_detail">DiasporaAdapter is the base class of adapters. Adapters are components that are in charge to interact with data sources (files, databases, etc etc) with standardized methods. You should not use this class directly: extend this class and re-implement some methods to build an adapter. See the (upcoming) tutorial section.</div><div class="dox_tag_title">In: <em>Adapters</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>classEntity </span><span class="dox_type">DataStoreEntity</span><span>- <p>Class used to spawn source entities</p></span></div><div class="dox_tag_title">Scope: <span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-44"><span class="kr">class</span> <span class="nx">DiasporaAdapter</span> <span class="kr">extends</span> <span class="nx">SequentialEvent</span> <span class="p">{</span>
</span><span id="line-45">    <span class="nx">constructor</span><span class="p">(</span> <span class="nx">classEntity</span><span class="p">,</span> <span class="nx">remaps</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">filters</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-46">        <span class="kr">super</span><span class="p">();</span>
</span><span id="line-47">        <span class="k">this</span><span class="p">.</span><span class="nx">remaps</span> <span class="o">=</span> <span class="nx">remaps</span><span class="p">;</span>
</span><span id="line-48">        <span class="k">this</span><span class="p">.</span><span class="nx">remapsInverted</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">invert</span><span class="p">(</span> <span class="nx">remaps</span> <span class="p">);</span>
</span><span id="line-49">        <span class="k">this</span><span class="p">.</span><span class="nx">classEntity</span> <span class="o">=</span> <span class="nx">classEntity</span><span class="p">;</span>
</span><span id="line-50">        <span class="k">this</span><span class="p">.</span><span class="nx">filters</span> <span class="o">=</span> <span class="nx">filters</span><span class="p">;</span>
</span><span id="line-51">        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="s1">&#39;ready&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-52">            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="s1">&#39;ready&#39;</span><span class="p">;</span>
</span><span id="line-53">        <span class="p">}).</span><span class="nx">on</span><span class="p">(</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-54">            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="p">;</span>
</span><span id="line-55">            <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">err</span><span class="p">;</span>
</span><span id="line-56">        <span class="p">});</span>
</span><span id="line-57">    <span class="p">}</span>
</span><span id="line-58">
</span><span id="line-59">
</span><span id="line-60"></pre></div></td></tr><tr class="section" id="section-14"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-14">&#182;</a></div><hr />

<h3>Utils</h3></td><td class="code"><div class="highlight"><pre></span><span id="line-61">
</span><span id="line-62">
</span><span id="line-63"></pre></div></td></tr><tr class="section" id="section-15"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-15">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>waitReady</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Returns a promise resolved once adapter state is ready</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved when adapter is ready, and rejected if an error occured</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-64">    <span class="nx">waitReady</span><span class="p">()</span> <span class="p">{</span>
</span><span id="line-65">        <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-66">            <span class="k">if</span> <span class="p">(</span> <span class="s1">&#39;ready&#39;</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-67">                <span class="k">return</span> <span class="nx">resolve</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
</span><span id="line-68">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="s1">&#39;error&#39;</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-69">                <span class="k">return</span> <span class="nx">reject</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="p">);</span>
</span><span id="line-70">            <span class="p">}</span>
</span><span id="line-71">            <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="s1">&#39;ready&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-72">                <span class="k">return</span> <span class="nx">resolve</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
</span><span id="line-73">            <span class="p">}).</span><span class="nx">on</span><span class="p">(</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-74">                <span class="k">return</span> <span class="nx">reject</span><span class="p">(</span> <span class="nx">err</span> <span class="p">);</span>
</span><span id="line-75">            <span class="p">});</span>
</span><span id="line-76">        <span class="p">});</span>
</span><span id="line-77">    <span class="p">}</span>
</span><span id="line-78">
</span><span id="line-79">
</span><span id="line-80"></pre></div></td></tr><tr class="section" id="section-16"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-16">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>remapInput</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>TODO</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">See</div><div class="dox_tag_detail"><span class="dox_type">TODO remapping</span></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table for which we remap</p></span></div><div class="dox_tag_detail"> <span>query </span><span class="dox_type">Object</span><span>- <p>Hash representing the entity to remap</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span><span><p>Remapped object</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-81">    <span class="nx">remapInput</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">query</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-82">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">query</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-83">            <span class="k">return</span> <span class="nx">query</span><span class="p">;</span>
</span><span id="line-84">        <span class="p">}</span>
</span><span id="line-85">        <span class="kr">const</span> <span class="nx">filtered</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">mapValues</span><span class="p">(</span> <span class="nx">query</span><span class="p">,</span> <span class="p">(</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-86">            <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">key</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-87">                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">input</span><span class="p">[</span><span class="nx">key</span><span class="p">](</span> <span class="nx">value</span> <span class="p">);</span>
</span><span id="line-88">            <span class="p">}</span>
</span><span id="line-89">            <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span><span id="line-90">        <span class="p">});</span>
</span><span id="line-91">        <span class="kr">const</span> <span class="nx">remaped</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">mapKeys</span><span class="p">(</span> <span class="nx">filtered</span><span class="p">,</span> <span class="p">(</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-92">            <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">remaps</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">key</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-93">                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">remaps</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span id="line-94">            <span class="p">}</span>
</span><span id="line-95">            <span class="k">return</span> <span class="nx">key</span><span class="p">;</span>
</span><span id="line-96">        <span class="p">});</span>
</span><span id="line-97">        <span class="k">return</span> <span class="nx">remaped</span><span class="p">;</span>
</span><span id="line-98">    <span class="p">}</span>
</span><span id="line-99">
</span><span id="line-100">
</span><span id="line-101"></pre></div></td></tr><tr class="section" id="section-17"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-17">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>remapOutput</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>TODO</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">See</div><div class="dox_tag_detail"><span class="dox_type">TODO remapping</span></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table for which we remap</p></span></div><div class="dox_tag_detail"> <span>query </span><span class="dox_type">Object</span><span>- <p>Hash representing the entity to remap</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span><span><p>Remapped object</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-102">    <span class="nx">remapOutput</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">query</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-103">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">query</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-104">            <span class="k">return</span> <span class="nx">query</span><span class="p">;</span>
</span><span id="line-105">        <span class="p">}</span>
</span><span id="line-106">        <span class="kr">const</span> <span class="nx">filtered</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">mapValues</span><span class="p">(</span> <span class="nx">query</span><span class="p">,</span> <span class="p">(</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-107">            <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">output</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">key</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-108">                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filters</span><span class="p">.</span><span class="nx">output</span><span class="p">[</span><span class="nx">key</span><span class="p">](</span> <span class="nx">value</span> <span class="p">);</span>
</span><span id="line-109">            <span class="p">}</span>
</span><span id="line-110">            <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
</span><span id="line-111">        <span class="p">});</span>
</span><span id="line-112">        <span class="kr">const</span> <span class="nx">remaped</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">mapKeys</span><span class="p">(</span> <span class="nx">filtered</span><span class="p">,</span> <span class="p">(</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-113">            <span class="k">if</span> <span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">remapsInverted</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">key</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-114">                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">remapsInverted</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span id="line-115">            <span class="p">}</span>
</span><span id="line-116">            <span class="k">return</span> <span class="nx">key</span><span class="p">;</span>
</span><span id="line-117">        <span class="p">});</span>
</span><span id="line-118">        <span class="k">return</span> <span class="nx">remaped</span><span class="p">;</span>
</span><span id="line-119">    <span class="p">}</span>
</span><span id="line-120">
</span><span id="line-121">
</span><span id="line-122"></pre></div></td></tr><tr class="section" id="section-18"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-18">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>entity </span><span class="dox_type">Object</span><span>- <p>Object containing attributes of the entity</p></span></div><div class="dox_tag_detail"> <span>propName </span><span class="dox_type">String</span><span>- <p>= 'id' Name of the <code>id</code> field</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span><span><p>Modified entity (for chaining)</p></span></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-123">    <span class="nx">setIdHash</span><span class="p">(</span> <span class="nx">entity</span><span class="p">,</span> <span class="nx">propName</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-124">        <span class="nx">entity</span><span class="p">.</span><span class="nx">idHash</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">entity</span><span class="p">.</span><span class="nx">idHash</span><span class="p">,</span> <span class="p">{</span>
</span><span id="line-125">            <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span><span class="o">:</span> <span class="nx">entity</span><span class="p">[</span><span class="nx">propName</span><span class="p">],</span>
</span><span id="line-126">        <span class="p">});</span>
</span><span id="line-127">        <span class="k">return</span> <span class="nx">entity</span><span class="p">;</span>
</span><span id="line-128">    <span class="p">}</span>
</span><span id="line-129">
</span><span id="line-130">
</span><span id="line-131"></pre></div></td></tr><tr class="section" id="section-19"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-19">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>query </span><span class="dox_type">QueryLanguage.SelectQuery</span><span>- <p>Query to match against</p></span></div><div class="dox_tag_detail"> <span>entity </span><span class="dox_type">Object</span><span>- <p>Entity to test</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Boolean</span><span><p><code>true</code> if query matches, <code>false</code> otherwise</p></span></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-132">    <span class="nx">matchEntity</span><span class="p">(</span> <span class="nx">query</span><span class="p">,</span> <span class="nx">entity</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-133">        <span class="kr">const</span> <span class="nx">matchResult</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">toPairs</span><span class="p">(</span> <span class="nx">query</span> <span class="p">),</span> <span class="p">([</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">desc</span> <span class="p">])</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-134">            <span class="k">if</span> <span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">object</span><span class="p">(</span> <span class="nx">desc</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-135">                <span class="kr">const</span> <span class="nx">entityVal</span> <span class="o">=</span> <span class="nx">entity</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span id="line-136">                <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span> <span class="nx">desc</span><span class="p">,</span> <span class="p">(</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">operation</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-137">                    <span class="k">switch</span> <span class="p">(</span> <span class="nx">operation</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-138">                        <span class="k">case</span> <span class="s1">&#39;$exists&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-139">                            <span class="k">return</span> <span class="nx">val</span> <span class="o">===</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">);</span>
</span><span id="line-140">                        <span class="p">}</span>
</span><span id="line-141">
</span><span id="line-142">                        <span class="k">case</span> <span class="s1">&#39;$equal&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-143">                            <span class="k">return</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entityVal</span> <span class="o">===</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-144">                        <span class="p">}</span>
</span><span id="line-145">
</span><span id="line-146">                        <span class="k">case</span> <span class="s1">&#39;$diff&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-147">                            <span class="k">return</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entityVal</span> <span class="o">!==</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-148">                        <span class="p">}</span>
</span><span id="line-149">
</span><span id="line-150">                        <span class="k">case</span> <span class="s1">&#39;$less&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-151">                            <span class="k">return</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entityVal</span> <span class="o">&lt;</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-152">                        <span class="p">}</span>
</span><span id="line-153">
</span><span id="line-154">                        <span class="k">case</span> <span class="s1">&#39;$lessEqual&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-155">                            <span class="k">return</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entityVal</span> <span class="o">&lt;=</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-156">                        <span class="p">}</span>
</span><span id="line-157">
</span><span id="line-158">                        <span class="k">case</span> <span class="s1">&#39;$greater&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-159">                            <span class="k">return</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entityVal</span> <span class="o">&gt;</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-160">                        <span class="p">}</span>
</span><span id="line-161">
</span><span id="line-162">                        <span class="k">case</span> <span class="s1">&#39;$greaterEqual&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span id="line-163">                            <span class="k">return</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">entityVal</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">entityVal</span> <span class="o">&gt;=</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-164">                        <span class="p">}</span>
</span><span id="line-165">                    <span class="p">}</span>
</span><span id="line-166">                    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span id="line-167">                <span class="p">});</span>
</span><span id="line-168">            <span class="p">}</span>
</span><span id="line-169">            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span id="line-170">        <span class="p">});</span>
</span><span id="line-171">        <span class="k">return</span> <span class="nx">matchResult</span><span class="p">;</span>
</span><span id="line-172">    <span class="p">}</span>
</span><span id="line-173">
</span><span id="line-174">    <span class="nx">applyUpdateEntity</span><span class="p">(</span> <span class="nx">update</span><span class="p">,</span> <span class="nx">entity</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-175">        <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span> <span class="nx">update</span><span class="p">,</span> <span class="p">(</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">key</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-176">            <span class="k">if</span> <span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="kc">undefined</span><span class="p">(</span> <span class="nx">val</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-177">                <span class="k">delete</span> <span class="nx">entity</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span id="line-178">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span id="line-179">                <span class="nx">entity</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
</span><span id="line-180">            <span class="p">}</span>
</span><span id="line-181">        <span class="p">});</span>
</span><span id="line-182">    <span class="p">}</span>
</span><span id="line-183">
</span><span id="line-184">
</span><span id="line-185"></pre></div></td></tr><tr class="section" id="section-20"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-20">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>normalizeOptions</em></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Transform options to their canonical form. This function must be applied before calling adapters' methods</p></div><div class="dox_tag_title">Throws:</div><div class="dox_tag_types"><span>Type: </span><span class="dox_type type-typeerror">TypeError</span></div><div class="dox_tag_detail"><p>Thrown if an option does not have an acceptable type</p></div><div class="dox_tag_title">Throws:</div><div class="dox_tag_types"><span>Type: </span><span class="dox_type type-referenceerror">ReferenceError</span></div><div class="dox_tag_detail"><p>Thrown if a required option is not present</p></div><div class="dox_tag_title">Throws:</div><div class="dox_tag_types"><span>Type: </span><span class="dox_type type-error">Error</span></div><div class="dox_tag_detail"><p>Thrown when there isn't more precise description of the error is available (eg. when conflicts occurs)</p></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>[opts={}] </span><span class="dox_type">Object</span><span>- <p>Options to transform</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Object</span><span><p>Transformed options (also called <code>canonical options</code>)</p></span></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-186">    <span class="nx">normalizeOptions</span><span class="p">(</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-187">        <span class="nx">opts</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">cloneDeep</span><span class="p">(</span> <span class="nx">opts</span> <span class="p">);</span>
</span><span id="line-188">        <span class="k">if</span> <span class="p">(</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="s1">&#39;limit&#39;</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-189">            <span class="kd">let</span> <span class="nx">limitOpt</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">limit</span><span class="p">;</span>
</span><span id="line-190">            <span class="k">if</span> <span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">string</span><span class="p">(</span> <span class="nx">limitOpt</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-191">                <span class="nx">limitOpt</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">limitOpt</span> <span class="p">);</span>
</span><span id="line-192">            <span class="p">}</span>
</span><span id="line-193">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">integer</span><span class="p">(</span> <span class="nx">limitOpt</span> <span class="p">)</span> <span class="o">||</span> <span class="kc">Infinity</span> <span class="o">===</span> <span class="nx">limitOpt</span> <span class="p">)</span> <span class="o">||</span> <span class="nx">limitOpt</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-194">                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="sb">`Expect &quot;options.limit&quot; to be an integer equal to or above 0, have </span><span class="si">${</span> <span class="nx">limitOpt</span> <span class="si">}</span><span class="sb">`</span> <span class="p">);</span>
</span><span id="line-195">            <span class="p">}</span>
</span><span id="line-196">            <span class="nx">opts</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="nx">limitOpt</span><span class="p">;</span>
</span><span id="line-197">        <span class="p">}</span>
</span><span id="line-198">        <span class="k">if</span> <span class="p">(</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="s1">&#39;skip&#39;</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-199">            <span class="kd">let</span> <span class="nx">skipOpt</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">skip</span><span class="p">;</span>
</span><span id="line-200">            <span class="k">if</span> <span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">string</span><span class="p">(</span> <span class="nx">skipOpt</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-201">                <span class="nx">skipOpt</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">skipOpt</span> <span class="p">);</span>
</span><span id="line-202">            <span class="p">}</span>
</span><span id="line-203">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">integer</span><span class="p">(</span> <span class="nx">skipOpt</span> <span class="p">)</span> <span class="o">||</span> <span class="nx">skipOpt</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="o">!</span><span class="nb">isFinite</span><span class="p">(</span> <span class="nx">skipOpt</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-204">                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="sb">`Expect &quot;options.skip&quot; to be a finite integer equal to or above 0, have </span><span class="si">${</span> <span class="nx">skipOpt</span> <span class="si">}</span><span class="sb">`</span> <span class="p">);</span>
</span><span id="line-205">            <span class="p">}</span>
</span><span id="line-206">            <span class="nx">opts</span><span class="p">.</span><span class="nx">skip</span> <span class="o">=</span> <span class="nx">skipOpt</span><span class="p">;</span>
</span><span id="line-207">        <span class="p">}</span>
</span><span id="line-208">        <span class="k">if</span> <span class="p">(</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="s1">&#39;page&#39;</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-209">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="s1">&#39;limit&#39;</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-210">                <span class="k">throw</span> <span class="k">new</span> <span class="nx">ReferenceError</span><span class="p">(</span> <span class="s1">&#39;Usage of &quot;options.page&quot; requires &quot;options.limit&quot; to be defined.&#39;</span> <span class="p">);</span>
</span><span id="line-211">            <span class="p">}</span>
</span><span id="line-212">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">isFinite</span><span class="p">(</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">limit</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-213">                <span class="k">throw</span> <span class="k">new</span> <span class="nx">ReferenceError</span><span class="p">(</span> <span class="s1">&#39;Usage of &quot;options.page&quot; requires &quot;options.limit&quot; to not be infinite&#39;</span> <span class="p">);</span>
</span><span id="line-214">            <span class="p">}</span>
</span><span id="line-215">            <span class="k">if</span> <span class="p">(</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="s1">&#39;skip&#39;</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-216">                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="s1">&#39;Use either &quot;options.page&quot; or &quot;options.skip&quot;&#39;</span> <span class="p">);</span>
</span><span id="line-217">            <span class="p">}</span>
</span><span id="line-218">            <span class="kd">let</span> <span class="nx">pageOpt</span> <span class="o">=</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">page</span><span class="p">;</span>
</span><span id="line-219">            <span class="k">if</span> <span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">string</span><span class="p">(</span> <span class="nx">pageOpt</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-220">                <span class="nx">pageOpt</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span> <span class="nx">pageOpt</span> <span class="p">);</span>
</span><span id="line-221">            <span class="p">}</span>
</span><span id="line-222">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">integer</span><span class="p">(</span> <span class="nx">pageOpt</span> <span class="p">)</span> <span class="o">||</span> <span class="nx">pageOpt</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-223">                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="sb">`Expect &quot;options.page&quot; to be an integer equal to or above 0, have </span><span class="si">${</span> <span class="nx">pageOpt</span> <span class="si">}</span><span class="sb">`</span> <span class="p">);</span>
</span><span id="line-224">            <span class="p">}</span>
</span><span id="line-225">            <span class="nx">opts</span><span class="p">.</span><span class="nx">skip</span> <span class="o">=</span> <span class="nx">pageOpt</span> <span class="o">*</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">limit</span><span class="p">;</span>
</span><span id="line-226">            <span class="k">delete</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">page</span><span class="p">;</span>
</span><span id="line-227">        <span class="p">}</span>
</span><span id="line-228">        <span class="nx">_</span><span class="p">.</span><span class="nx">defaults</span><span class="p">(</span> <span class="nx">opts</span><span class="p">,</span> <span class="p">{</span>
</span><span id="line-229">            <span class="nx">skip</span><span class="o">:</span>        <span class="mi">0</span><span class="p">,</span>
</span><span id="line-230">            <span class="nx">remapInput</span><span class="o">:</span>  <span class="kc">true</span><span class="p">,</span>
</span><span id="line-231">            <span class="nx">remapOutput</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span id="line-232">        <span class="p">});</span>
</span><span id="line-233">        <span class="k">return</span> <span class="nx">opts</span><span class="p">;</span>
</span><span id="line-234">    <span class="p">}</span>
</span><span id="line-235">
</span><span id="line-236">    <span class="nx">normalizeQuery</span><span class="p">(</span> <span class="nx">originalQuery</span><span class="p">,</span> <span class="nx">options</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-237">        <span class="kr">const</span> <span class="nx">canonicalOperations</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="line-238">            <span class="s1">&#39;~&#39;</span><span class="o">:</span>  <span class="s1">&#39;$exists&#39;</span><span class="p">,</span>
</span><span id="line-239">            <span class="s1">&#39;==&#39;</span><span class="o">:</span> <span class="s1">&#39;$equal&#39;</span><span class="p">,</span>
</span><span id="line-240">            <span class="s1">&#39;!=&#39;</span><span class="o">:</span> <span class="s1">&#39;$diff&#39;</span><span class="p">,</span>
</span><span id="line-241">            <span class="s1">&#39;&lt;&#39;</span><span class="o">:</span>  <span class="s1">&#39;$less&#39;</span><span class="p">,</span>
</span><span id="line-242">            <span class="s1">&#39;&lt;=&#39;</span><span class="o">:</span> <span class="s1">&#39;$lessEqual&#39;</span><span class="p">,</span>
</span><span id="line-243">            <span class="s1">&#39;&gt;&#39;</span><span class="o">:</span>  <span class="s1">&#39;$greater&#39;</span><span class="p">,</span>
</span><span id="line-244">            <span class="s1">&#39;&gt;=&#39;</span><span class="o">:</span> <span class="s1">&#39;$greaterEqual&#39;</span><span class="p">,</span>
</span><span id="line-245">        <span class="p">};</span>
</span><span id="line-246">        <span class="kr">const</span> <span class="nx">normalizedQuery</span> <span class="o">=</span> <span class="kc">true</span> <span class="o">===</span> <span class="nx">options</span><span class="p">.</span><span class="nx">remapInput</span> <span class="o">?</span> <span class="nx">_</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">cloneDeep</span><span class="p">(</span> <span class="nx">originalQuery</span> <span class="p">)).</span><span class="nx">mapValues</span><span class="p">((</span> <span class="nx">attrSearch</span><span class="p">,</span> <span class="nx">attrName</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-247">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">attrSearch</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">attrSearch</span> <span class="k">instanceof</span> <span class="nb">Object</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-248">                <span class="k">if</span> <span class="p">(</span> <span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">attrSearch</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-249">                    <span class="k">return</span> <span class="p">{</span>
</span><span id="line-250">                        <span class="nx">$equal</span><span class="o">:</span> <span class="nx">attrSearch</span><span class="p">,</span>
</span><span id="line-251">                    <span class="p">};</span>
</span><span id="line-252">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span id="line-253">                    <span class="k">return</span> <span class="p">{</span>
</span><span id="line-254">                        <span class="nx">$exists</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span id="line-255">                    <span class="p">};</span>
</span><span id="line-256">                <span class="p">}</span>
</span><span id="line-257">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span id="line-258">
</span><span id="line-259"></pre></div></td></tr><tr class="section" id="section-21"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-21">&#182;</a></div><p>Replace operations alias by canonical expressions</p></td><td class="code"><div class="highlight"><pre></span><span id="line-260">                <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span> <span class="nx">canonicalOperations</span><span class="p">,</span> <span class="p">(</span> <span class="nx">canon</span><span class="p">,</span> <span class="nx">alias</span> <span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-261">
</span><span id="line-262"></pre></div></td></tr><tr class="section" id="section-22"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-22">&#182;</a></div><p>If the currently checked alias is in the search hash...</p></td><td class="code"><div class="highlight"><pre></span><span id="line-263">                    <span class="k">if</span> <span class="p">(</span> <span class="nx">attrSearch</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">alias</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-264">
</span><span id="line-265"></pre></div></td></tr><tr class="section" id="section-23"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-23">&#182;</a></div><p>... check for conflict with canonical operation name...</p></td><td class="code"><div class="highlight"><pre></span><span id="line-266">                        <span class="k">if</span> <span class="p">(</span> <span class="nx">attrSearch</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">canon</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-267">                            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span> <span class="sb">`Search can&#39;t have both &quot;</span><span class="si">${</span> <span class="nx">alias</span> <span class="si">}</span><span class="sb">&quot; and &quot;</span><span class="si">${</span> <span class="nx">canon</span> <span class="si">}</span><span class="sb">&quot; keys, as they are synonyms`</span> <span class="p">);</span>
</span><span id="line-268">                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span id="line-269">
</span><span id="line-270"></pre></div></td></tr><tr class="section" id="section-24"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-24">&#182;</a></div><p>... and replace alias by canonical</p></td><td class="code"><div class="highlight"><pre></span><span id="line-271">                            <span class="nx">attrSearch</span><span class="p">[</span><span class="nx">canon</span><span class="p">]</span> <span class="o">=</span> <span class="nx">attrSearch</span><span class="p">[</span><span class="nx">alias</span><span class="p">];</span>
</span><span id="line-272">                            <span class="k">delete</span> <span class="nx">attrSearch</span><span class="p">[</span><span class="nx">alias</span><span class="p">];</span>
</span><span id="line-273">                        <span class="p">}</span>
</span><span id="line-274">                    <span class="p">}</span>
</span><span id="line-275">                <span class="p">});</span>
</span><span id="line-276">
</span><span id="line-277"></pre></div></td></tr><tr class="section" id="section-25"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-25">&#182;</a></div><p>For arithmetic comparison, check if values are numeric (TODO later: support date)</p></td><td class="code"><div class="highlight"><pre></span><span id="line-278">                <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span><span class="p">([</span> <span class="s1">&#39;$less&#39;</span><span class="p">,</span> <span class="s1">&#39;$lessEqual&#39;</span><span class="p">,</span> <span class="s1">&#39;$greater&#39;</span><span class="p">,</span> <span class="s1">&#39;$greaterEqual&#39;</span> <span class="p">],</span> <span class="nx">operation</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-279">                    <span class="k">if</span> <span class="p">(</span> <span class="nx">attrSearch</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span> <span class="nx">operation</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">number</span><span class="p">(</span> <span class="nx">attrSearch</span><span class="p">[</span><span class="nx">operation</span><span class="p">]))</span> <span class="p">{</span>
</span><span id="line-280">                        <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span> <span class="sb">`Expect &quot;</span><span class="si">${</span> <span class="nx">operation</span> <span class="si">}</span><span class="sb">&quot; in </span><span class="si">${</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span> <span class="nx">attrSearch</span> <span class="p">)</span> <span class="si">}</span><span class="sb"> to be a numeric value`</span> <span class="p">);</span>
</span><span id="line-281">                    <span class="p">}</span>
</span><span id="line-282">                <span class="p">});</span>
</span><span id="line-283">                <span class="k">return</span> <span class="nx">attrSearch</span><span class="p">;</span>
</span><span id="line-284">            <span class="p">}</span>
</span><span id="line-285">        <span class="p">}).</span><span class="nx">value</span><span class="p">()</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">cloneDeep</span><span class="p">(</span> <span class="nx">originalQuery</span> <span class="p">);</span>
</span><span id="line-286">        <span class="k">return</span> <span class="nx">normalizedQuery</span><span class="p">;</span>
</span><span id="line-287">    <span class="p">}</span>
</span><span id="line-288">
</span><span id="line-289">
</span><span id="line-290"></pre></div></td></tr><tr class="section" id="section-26"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-26">&#182;</a></div><hr />

<h3>Insert</h3></td><td class="code"><div class="highlight"><pre></span><span id="line-291">
</span><span id="line-292">
</span><span id="line-293"></pre></div></td></tr><tr class="section" id="section-27"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-27">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>insertOne</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link insertOne} or {@link insertMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Insert a single entity in the data store. This function is a default polyfill if the inheriting adapter does not provide <code>insertOne</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to insert data in</p></span></div><div class="dox_tag_detail"> <span>entity </span><span class="dox_type">Object</span><span>- <p>Hash representing the entity to insert</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once insertion is done. Called with (<em>{@link DataStoreEntity}</em> entity)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-294">    <span class="nx">insertOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">entity</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-295">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">insertMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="p">[</span> <span class="nx">entity</span> <span class="p">]).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">entities</span> <span class="p">=&gt;</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">(</span> <span class="nx">entities</span> <span class="p">)));</span>
</span><span id="line-296">    <span class="p">}</span>
</span><span id="line-297">
</span><span id="line-298">
</span><span id="line-299"></pre></div></td></tr><tr class="section" id="section-28"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-28">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>insertMany</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link insertOne} or {@link insertMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Insert several entities in the data store. This function is a default polyfill if the inheriting adapter does not provide <code>insertMany</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to insert data in</p></span></div><div class="dox_tag_detail"> <span>entities </span><span class="dox_type">Array.&lt;Object&gt;</span><span>- <p>Array of hashs representing the entities to insert</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once insertion is done. Called with (<em>{@link DataStoreEntity}[]</em> entities)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-300">    <span class="nx">insertMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">entities</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-301">        <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">mapSeries</span><span class="p">(</span> <span class="nx">entities</span><span class="p">,</span> <span class="nx">entity</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">insertOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">entity</span> <span class="o">||</span> <span class="p">{}));</span>
</span><span id="line-302">    <span class="p">}</span>
</span><span id="line-303">
</span><span id="line-304">
</span><span id="line-305"></pre></div></td></tr><tr class="section" id="section-29"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-29">&#182;</a></div><hr />

<h3>Find</h3></td><td class="code"><div class="highlight"><pre></span><span id="line-306">
</span><span id="line-307">
</span><span id="line-308"></pre></div></td></tr><tr class="section" id="section-30"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-30">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>findOne</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link findOne} or {@link findMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Retrieve a single entity from the data store. This function is a default polyfill if the inheriting adapter does not provide <code>findOne</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to retrieve data from</p></span></div><div class="dox_tag_detail"> <span>queryFind </span><span class="dox_type">SelectQueryOrCondition</span><span>- <p>Hash representing the entity to find</p></span></div><div class="dox_tag_detail"> <span>[options={}] </span><span class="dox_type">QueryOptions</span><span>- <p>Hash of options.</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once item is found. Called with (<em>{@link DataStoreEntity}</em> <code>entity</code>)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-309">    <span class="nx">findOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-310">        <span class="nx">options</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span id="line-311">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">findMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">entities</span> <span class="p">=&gt;</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">(</span> <span class="nx">entities</span> <span class="p">)));</span>
</span><span id="line-312">    <span class="p">}</span>
</span><span id="line-313">
</span><span id="line-314">
</span><span id="line-315"></pre></div></td></tr><tr class="section" id="section-31"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-31">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>findMany</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link findOne} or {@link findMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Retrieve several entities from the data store. This function is a default polyfill if the inheriting adapter does not provide <code>findMany</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to retrieve data from</p></span></div><div class="dox_tag_detail"> <span>queryFind </span><span class="dox_type">SelectQueryOrCondition</span><span>- <p>Hash representing entities to find</p></span></div><div class="dox_tag_detail"> <span>[options={}] </span><span class="dox_type">QueryOptions</span><span>- <p>Hash of options.</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once item is found. Called with (<em>{@link DataStoreEntity}[]</em> <code>entities</code>)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-316">    <span class="nx">findMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-317">        <span class="kr">const</span> <span class="nx">foundEntities</span> <span class="o">=</span> <span class="p">[];</span>
</span><span id="line-318">        <span class="nx">options</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">normalizeOptions</span><span class="p">(</span> <span class="nx">options</span> <span class="p">);</span>
</span><span id="line-319">        <span class="kd">let</span> <span class="nx">foundCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="line-320">        <span class="kd">let</span> <span class="nx">origSkip</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">skip</span><span class="p">;</span>
</span><span id="line-321">
</span><span id="line-322">
</span><span id="line-323"></pre></div></td></tr><tr class="section" id="section-32"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-32">&#182;</a></div><p>We are going to loop until we find enough items</p></td><td class="code"><div class="highlight"><pre></span><span id="line-324">        <span class="kr">const</span> <span class="nx">loopFind</span> <span class="o">=</span> <span class="nx">found</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-325">
</span><span id="line-326"></pre></div></td></tr><tr class="section" id="section-33"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-33">&#182;</a></div><p>If the search returned nothing, then just finish the findMany</p></td><td class="code"><div class="highlight"><pre></span><span id="line-327">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">found</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-328">                <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">foundEntities</span> <span class="p">);</span>
</span><span id="line-329">
</span><span id="line-330"></pre></div></td></tr><tr class="section" id="section-34"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-34">&#182;</a></div><p>Else, if this is a value and not the initial <code>true</code>, add it to the list</p></td><td class="code"><div class="highlight"><pre></span><span id="line-331">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">found</span> <span class="o">!==</span> <span class="kc">true</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-332">                <span class="nx">foundEntities</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">found</span> <span class="p">);</span>
</span><span id="line-333">            <span class="p">}</span>
</span><span id="line-334">
</span><span id="line-335"></pre></div></td></tr><tr class="section" id="section-35"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-35">&#182;</a></div><p>If we found enough items, return them</p></td><td class="code"><div class="highlight"><pre></span><span id="line-336">            <span class="k">if</span> <span class="p">(</span> <span class="nx">foundCount</span> <span class="o">===</span> <span class="nx">options</span><span class="p">.</span><span class="nx">limit</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-337">                <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">foundEntities</span> <span class="p">);</span>
</span><span id="line-338">            <span class="p">}</span>
</span><span id="line-339">            <span class="nx">options</span><span class="p">.</span><span class="nx">skip</span> <span class="o">=</span> <span class="nx">origSkip</span> <span class="o">+</span> <span class="nx">foundCount</span><span class="p">;</span>
</span><span id="line-340">
</span><span id="line-341"></pre></div></td></tr><tr class="section" id="section-36"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-36">&#182;</a></div><p>Next time we'll skip 1 more item</p></td><td class="code"><div class="highlight"><pre></span><span id="line-342">            <span class="nx">foundCount</span><span class="o">++</span><span class="p">;</span>
</span><span id="line-343">
</span><span id="line-344"></pre></div></td></tr><tr class="section" id="section-37"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-37">&#182;</a></div><p>Do the query &amp; loop</p></td><td class="code"><div class="highlight"><pre></span><span id="line-345">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">loopFind</span> <span class="p">);</span>
</span><span id="line-346">        <span class="p">};</span>
</span><span id="line-347">        <span class="k">return</span> <span class="nx">loopFind</span><span class="p">(</span> <span class="kc">true</span> <span class="p">);</span>
</span><span id="line-348">    <span class="p">}</span>
</span><span id="line-349">
</span><span id="line-350">
</span><span id="line-351"></pre></div></td></tr><tr class="section" id="section-38"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-38">&#182;</a></div><hr />

<h3>Update</h3></td><td class="code"><div class="highlight"><pre></span><span id="line-352">
</span><span id="line-353">
</span><span id="line-354"></pre></div></td></tr><tr class="section" id="section-39"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-39">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>updateOne</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link updateOne} or {@link updateMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Update a single entity from the data store. This function is a default polyfill if the inheriting adapter does not provide <code>updateOne</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to retrieve data from</p></span></div><div class="dox_tag_detail"> <span>queryFind </span><span class="dox_type">SelectQueryOrCondition</span><span>- <p>Hash representing the entity to find</p></span></div><div class="dox_tag_detail"> <span>update </span><span class="dox_type">Object</span><span>- <p>Object properties to set</p></span></div><div class="dox_tag_detail"> <span>[options={}] </span><span class="dox_type">QueryOptions</span><span>- <p>Hash of options.</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once item is found. Called with (<em>{@link DataStoreEntity}</em> <code>entity</code>)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-355">    <span class="nx">updateOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">update</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-356">        <span class="nx">options</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span id="line-357">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">updateMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">update</span><span class="p">,</span> <span class="nx">options</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">entities</span> <span class="p">=&gt;</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">(</span> <span class="nx">entities</span> <span class="p">)));</span>
</span><span id="line-358">    <span class="p">}</span>
</span><span id="line-359">
</span><span id="line-360">
</span><span id="line-361"></pre></div></td></tr><tr class="section" id="section-40"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-40">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>updateMany</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link updateOne} or {@link updateMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Update several entities from the data store. This function is a default polyfill if the inheriting adapter does not provide <code>updateMany</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to retrieve data from</p></span></div><div class="dox_tag_detail"> <span>queryFind </span><span class="dox_type">SelectQueryOrCondition</span><span>- <p>Hash representing entities to find</p></span></div><div class="dox_tag_detail"> <span>update </span><span class="dox_type">Object</span><span>- <p>Object properties to set</p></span></div><div class="dox_tag_detail"> <span>[options={}] </span><span class="dox_type">QueryOptions</span><span>- <p>Hash of options.</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once item is found. Called with (<em>{@link DataStoreEntity}[]</em> <code>entities</code>)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-362">    <span class="nx">updateMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">update</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-363">        <span class="kr">const</span> <span class="nx">foundEntities</span> <span class="o">=</span> <span class="p">[];</span>
</span><span id="line-364">        <span class="kd">let</span> <span class="nx">skip</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="line-365">
</span><span id="line-366">
</span><span id="line-367"></pre></div></td></tr><tr class="section" id="section-41"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-41">&#182;</a></div><p>We are going to loop until we find enough items</p></td><td class="code"><div class="highlight"><pre></span><span id="line-368">        <span class="kr">const</span> <span class="nx">loopFind</span> <span class="o">=</span> <span class="nx">found</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-369">
</span><span id="line-370"></pre></div></td></tr><tr class="section" id="section-42"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-42">&#182;</a></div><p>If the search returned nothing, then just finish the findMany</p></td><td class="code"><div class="highlight"><pre></span><span id="line-371">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">found</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-372">                <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">foundEntities</span> <span class="p">);</span>
</span><span id="line-373">
</span><span id="line-374"></pre></div></td></tr><tr class="section" id="section-43"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-43">&#182;</a></div><p>Else, if this is a value and not the initial <code>true</code>, add it to the list</p></td><td class="code"><div class="highlight"><pre></span><span id="line-375">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">found</span> <span class="o">!==</span> <span class="kc">true</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-376">                <span class="nx">foundEntities</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="nx">found</span> <span class="p">);</span>
</span><span id="line-377">            <span class="p">}</span>
</span><span id="line-378">
</span><span id="line-379"></pre></div></td></tr><tr class="section" id="section-44"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-44">&#182;</a></div><p>If we found enough items, return them</p></td><td class="code"><div class="highlight"><pre></span><span id="line-380">            <span class="k">if</span> <span class="p">(</span> <span class="nx">skip</span> <span class="o">===</span> <span class="nx">options</span><span class="p">.</span><span class="nx">limit</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-381">                <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span> <span class="nx">foundEntities</span> <span class="p">);</span>
</span><span id="line-382">            <span class="p">}</span>
</span><span id="line-383">            <span class="nx">options</span><span class="p">.</span><span class="nx">skip</span> <span class="o">=</span> <span class="nx">skip</span><span class="p">;</span>
</span><span id="line-384">
</span><span id="line-385"></pre></div></td></tr><tr class="section" id="section-45"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-45">&#182;</a></div><p>Next time we'll skip 1 more item</p></td><td class="code"><div class="highlight"><pre></span><span id="line-386">            <span class="nx">skip</span><span class="o">++</span><span class="p">;</span>
</span><span id="line-387">
</span><span id="line-388"></pre></div></td></tr><tr class="section" id="section-46"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-46">&#182;</a></div><p>Do the query &amp; loop</p></td><td class="code"><div class="highlight"><pre></span><span id="line-389">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">updateOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">update</span><span class="p">,</span> <span class="nx">options</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">loopFind</span> <span class="p">);</span>
</span><span id="line-390">        <span class="p">};</span>
</span><span id="line-391">        <span class="k">return</span> <span class="nx">loopFind</span><span class="p">(</span> <span class="kc">true</span> <span class="p">);</span>
</span><span id="line-392">    <span class="p">}</span>
</span><span id="line-393">
</span><span id="line-394">
</span><span id="line-395"></pre></div></td></tr><tr class="section" id="section-47"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-47">&#182;</a></div><hr />

<h3>Delete</h3></td><td class="code"><div class="highlight"><pre></span><span id="line-396">
</span><span id="line-397">
</span><span id="line-398"></pre></div></td></tr><tr class="section" id="section-48"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-48">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>deleteOne</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link deleteOne} or {@link deleteMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Update a single entity from the data store. This function is a default polyfill if the inheriting adapter does not provide <code>deleteOne</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to delete data from</p></span></div><div class="dox_tag_detail"> <span>queryFind </span><span class="dox_type">SelectQueryOrCondition</span><span>- <p>Hash representing the entities to find</p></span></div><div class="dox_tag_detail"> <span>[options={}] </span><span class="dox_type">QueryOptions</span><span>- <p>Hash of options.</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once item is found. Called with (<em>{@link DataStoreEntity}</em> <code>entity</code>)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-399">    <span class="nx">deleteOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-400">        <span class="nx">options</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span id="line-401">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deleteMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="p">);</span>
</span><span id="line-402">    <span class="p">}</span>
</span><span id="line-403">
</span><span id="line-404">
</span><span id="line-405"></pre></div></td></tr><tr class="section" id="section-49"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-49">&#182;</a></div><div class="dox"><div class="details"><div class="dox_tag_title">Method <em>deleteMany</em></div><div class="dox_tag_title">Summary:</div><div class="dox_tag_detail"><p>At least one of {@link deleteOne} or {@link deleteMany} must be reimplemented by adapter</p></div><div class="dox_tag_title">Description:</div><div class="dox_tag_detail"><p>Update several entities from the data store. This function is a default polyfill if the inheriting adapter does not provide <code>deleteMany</code> itself</p></div><div class="dox_tag_title">In: <em>Adapters.DiasporaAdapter</em></div><div class="dox_tag_title">Params</div><div class="dox_tag_detail"> <span>table </span><span class="dox_type">String</span><span>- <p>Name of the table to delete data from</p></span></div><div class="dox_tag_detail"> <span>queryFind </span><span class="dox_type">SelectQueryOrCondition</span><span>- <p>Hash representing the entities to find</p></span></div><div class="dox_tag_detail"> <span>[options={}] </span><span class="dox_type">QueryOptions</span><span>- <p>Hash of options.</p></span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Promise</span><span><p>Promise resolved once item is found. Called with (<em>{@link DataStoreEntity}[]</em> <code>entities</code>)</p></span></div><div class="dox_tag_title">Scope: <span class="object">instance</span><span class="modifier">public</span></div><div class="dox_tag_title">Author</div><div class="dox_tag_detail"><gerkin></gerkin></div></div><div class="body"></div></div></td><td class="code"><div class="highlight"><pre></span><span id="line-406">    <span class="nx">deleteMany</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
</span><span id="line-407">        <span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="line-408">
</span><span id="line-409">
</span><span id="line-410"></pre></div></td></tr><tr class="section" id="section-50"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-50">&#182;</a></div><p>We are going to loop until we find enough items</p></td><td class="code"><div class="highlight"><pre></span><span id="line-411">        <span class="kr">const</span> <span class="nx">loopFind</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-412">
</span><span id="line-413"></pre></div></td></tr><tr class="section" id="section-51"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-51">&#182;</a></div><p>First, search for the item.</p></td><td class="code"><div class="highlight"><pre></span><span id="line-414">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">findOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">found</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span id="line-415">
</span><span id="line-416"></pre></div></td></tr><tr class="section" id="section-52"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-52">&#182;</a></div><p>If the search returned nothing, then just finish the findMany</p></td><td class="code"><div class="highlight"><pre></span><span id="line-417">                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">c</span><span class="p">.</span><span class="nx">assigned</span><span class="p">(</span> <span class="nx">found</span> <span class="p">))</span> <span class="p">{</span>
</span><span id="line-418">                    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
</span><span id="line-419">
</span><span id="line-420"></pre></div></td></tr><tr class="section" id="section-53"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-53">&#182;</a></div><p>Else, if this is a value and not the initial <code>true</code>, add it to the list</p></td><td class="code"><div class="highlight"><pre></span><span id="line-421">                <span class="p">}</span>
</span><span id="line-422">
</span><span id="line-423"></pre></div></td></tr><tr class="section" id="section-54"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-54">&#182;</a></div><p>If we found enough items, return them</p></td><td class="code"><div class="highlight"><pre></span><span id="line-424">                <span class="k">if</span> <span class="p">(</span> <span class="nx">count</span> <span class="o">===</span> <span class="nx">options</span><span class="p">.</span><span class="nx">limit</span> <span class="p">)</span> <span class="p">{</span>
</span><span id="line-425">                    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
</span><span id="line-426">                <span class="p">}</span>
</span><span id="line-427">
</span><span id="line-428"></pre></div></td></tr><tr class="section" id="section-55"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-55">&#182;</a></div><p>Increase our counter</p></td><td class="code"><div class="highlight"><pre></span><span id="line-429">                <span class="nx">count</span><span class="o">++</span><span class="p">;</span>
</span><span id="line-430">
</span><span id="line-431"></pre></div></td></tr><tr class="section" id="section-56"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-56">&#182;</a></div><p>Do the deletion &amp; loop</p></td><td class="code"><div class="highlight"><pre></span><span id="line-432">                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deleteOne</span><span class="p">(</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">queryFind</span><span class="p">,</span> <span class="nx">options</span> <span class="p">).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">loopFind</span> <span class="p">);</span>
</span><span id="line-433">            <span class="p">});</span>
</span><span id="line-434">        <span class="p">};</span>
</span><span id="line-435">        <span class="k">return</span> <span class="nx">loopFind</span><span class="p">(</span> <span class="kc">true</span> <span class="p">);</span>
</span><span id="line-436">    <span class="p">}</span>
</span><span id="line-437"><span class="p">}</span>
</span><span id="line-438">
</span><span id="line-439"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">DiasporaAdapter</span><span class="p">;</span>
</span>
</pre></div></td></tr></tbody></table></div>
				</section>
			</div>

			<footer>
				<p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
			</footer>
		</div>
		<!--[if !IE]><script defer>fixScale(document);</script><![endif]-->
		
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
							})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-61219056-7', 'auto');
	ga('send', 'pageview');
</script>


<script type="text/javascript">
	window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
	heap.load("3159885702");
</script>

		<script>
			/**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

			var disqus_config = function () {
				this.page.url = "https://diaspora.ithoughts.io/docco/lib/adapters/baseAdapter.js.html";  // Replace PAGE_URL with your page's canonical URL variable
				this.page.identifier = "baseAdapter.js"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
			};
			(function() {  // DON'T EDIT BELOW THIS LINE
				var d = document, s = d.createElement('script');

				s.src = 'https://diaspora-orm.disqus.com/embed.js';

				s.setAttribute('data-timestamp', +new Date());
				(d.head || d.body).appendChild(s);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</body>
</html>
